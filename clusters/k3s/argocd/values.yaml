# ArgoCD Helm Values
# Customize these values for your deployment
# Docs: https://github.com/argoproj/argo-helm/tree/main/charts/argo-cd

global:
  # -- Default domain used by all components
  domain: argocd.local

## Server
server:
  # -- ArgoCD server name
  name: server

  # -- Number of replicas
  replicas: 1

  ## Ingress configuration
  ingress:
    enabled: true
    ingressClassName: "traefik" # Change to your ingress controller (nginx, traefik, etc.)
    hostname: argocd.local
    annotations:
      # For HTTPS termination at ingress level
      # nginx.ingress.kubernetes.io/ssl-passthrough: "true"
      # nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
    tls: false
    # tls:
    #   - secretName: argocd-tls
    #     hosts:
    #       - argocd.local

  # -- Disable TLS on the server (use if terminating TLS at ingress)
  extraArgs:
    - --insecure

## Controller
controller:
  replicas: 1

## Repo Server
repoServer:
  replicas: 1

## ApplicationSet Controller
applicationSet:
  replicas: 1

## Redis
redis:
  enabled: true

## Dex (OIDC provider)
dex:
  enabled: true

## Notifications
notifications:
  enabled: true

## Configs
configs:
  # -- Known hosts for SSH repositories
  ssh:
    knownHosts: ""

  # -- Repository credentials
  repositories:
    {}
    # my-private-repo:
    #   url: https://github.com/myorg/myrepo
    #   password: my-password
    #   username: my-username

  # -- ConfigMap with extra configuration
  cm:
    # -- Create the argocd-cm configmap
    create: true

    # -- Enable exec feature
    exec.enabled: "true"

    # -- Application health assessment
    resource.customizations.health.argoproj.io_Application: |
      hs = {}
      hs.status = "Progressing"
      hs.message = ""
      if obj.status ~= nil then
        if obj.status.health ~= nil then
          hs.status = obj.status.health.status
          if obj.status.health.message ~= nil then
            hs.message = obj.status.health.message
          end
        end
      end
      return hs

  params:
    # -- Enable insecure mode (if TLS terminated at ingress)
    server.insecure: true

  # -- RBAC configuration
  rbac:
    # -- Create the argocd-rbac-cm configmap
    create: true
    # -- Default policy
    policy.default: role:readonly
    # -- Policy rules
    policy.csv: |
      g, admin, role:admin
